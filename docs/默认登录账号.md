# WorkFlowCore é»˜è®¤ç™»å½•è´¦å·

## ğŸ“‹ é»˜è®¤è´¦å·åˆ—è¡¨

### 1. ç®¡ç†å‘˜è´¦å·

**ç”¨æˆ·å**ï¼š`admin`  
**å¯†ç **ï¼š`admin123`  
**è§’è‰²**ï¼šAdmin (ç®¡ç†å‘˜)  
**é‚®ç®±**ï¼šadmin@workflowcore.com  

**æƒé™**ï¼š
- âœ… å®Œæ•´ç³»ç»Ÿç®¡ç†æƒé™
- âœ… ç”¨æˆ·ç®¡ç†
- âœ… è§’è‰²ç®¡ç†
- âœ… æµç¨‹å®šä¹‰ç®¡ç†
- âœ… ç³»ç»Ÿé…ç½®

---

### 2. æµ‹è¯•ç”¨æˆ·è´¦å·

**ç”¨æˆ·å**ï¼š`test`  
**å¯†ç **ï¼š`test123`  
**è§’è‰²**ï¼šæ™®é€šç”¨æˆ·  
**é‚®ç®±**ï¼štest@workflowcore.com  

**æƒé™**ï¼š
- âœ… åŸºç¡€æµç¨‹æ“ä½œ
- âŒ ç³»ç»Ÿç®¡ç†åŠŸèƒ½ï¼ˆå—é™ï¼‰

---

## ğŸš€ é¦–æ¬¡å¯åŠ¨åˆå§‹åŒ–

ç³»ç»Ÿé¦–æ¬¡å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹åˆå§‹åŒ–ï¼š

1. **åº”ç”¨æ•°æ®åº“è¿ç§»**ï¼š`dotnet ef database update`
2. **åˆ›å»ºæµ‹è¯•ç§Ÿæˆ·**ï¼šç§Ÿæˆ· ID = `00000000-0000-0000-0000-000000000001`
3. **åˆ›å»ºç®¡ç†å‘˜è§’è‰²**ï¼š`Admin`
4. **åˆ›å»ºé»˜è®¤è´¦å·**ï¼šä¸Šè¿°ä¸¤ä¸ªè´¦å·

### å¯åŠ¨å‘½ä»¤

```bash
# åç«¯å¯åŠ¨ï¼ˆé¡¹ç›®æ ¹ç›®å½•ï¼‰
dotnet run --project src/WorkFlowCore.API

# å‰ç«¯å¯åŠ¨ï¼ˆfrontend ç›®å½•ï¼‰
cd frontend
npm run dev
```

---

## ğŸ”‘ ç™»å½•æ–¹å¼

### æ–¹å¼ 1ï¼šç”¨æˆ·å + å¯†ç ç™»å½•

1. æ‰“å¼€å‰ç«¯é¡µé¢ï¼š`http://localhost:5173/login`
2. é€‰æ‹©ã€Œè´¦å·å¯†ç ç™»å½•ã€æ ‡ç­¾
3. è¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
4. ç‚¹å‡»ã€Œç™»å½•ã€

### æ–¹å¼ 2ï¼šæ‰‹æœºå· + çŸ­ä¿¡éªŒè¯ç ç™»å½•ï¼ˆéœ€é…ç½®çŸ­ä¿¡æœåŠ¡ï¼‰

1. è¾“å…¥æ‰‹æœºå·
2. ç‚¹å‡»ã€Œè·å–éªŒè¯ç ã€
3. è¾“å…¥æ”¶åˆ°çš„éªŒè¯ç 
4. ç‚¹å‡»ã€Œç™»å½•ã€

### æ–¹å¼ 3ï¼šæ‰«ç ç™»å½•ï¼ˆæœªå¯ç”¨ï¼‰

å½“å‰ç‰ˆæœ¬æš‚æœªå¯ç”¨äºŒç»´ç ç™»å½•åŠŸèƒ½ã€‚

### æ–¹å¼ 4ï¼šç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆéœ€é…ç½®ï¼‰

æ”¯æŒä»¥ä¸‹ç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆéœ€åœ¨ `appsettings.json` é…ç½®ï¼‰ï¼š
- å¾®ä¿¡ç™»å½•
- QQ ç™»å½•
- æ”¯ä»˜å®ç™»å½•
- Apple ç™»å½•

---

## ğŸ”§ ä¿®æ”¹é»˜è®¤å¯†ç 

### æ–¹æ³• 1ï¼šé€šè¿‡å‰ç«¯ä¿®æ”¹

1. ä½¿ç”¨ç®¡ç†å‘˜è´¦å·ç™»å½•
2. è¿›å…¥ã€Œç³»ç»Ÿç®¡ç†ã€â†’ã€Œç”¨æˆ·ç®¡ç†ã€
3. ç‚¹å‡»ç”¨æˆ·æ“ä½œæ çš„ã€Œé‡ç½®å¯†ç ã€
4. è¾“å…¥æ–°å¯†ç 

### æ–¹æ³• 2ï¼šé€šè¿‡ä»£ç ä¿®æ”¹

ä¿®æ”¹ `src/WorkFlowCore.API/DataSeeder.cs` æ–‡ä»¶ä¸­çš„å¯†ç ï¼š

```csharp
var result = await userManager.CreateAsync(adminUser, "your-new-password");
```

ç„¶ååˆ é™¤æ•°æ®åº“æ–‡ä»¶é‡æ–°å¯åŠ¨ï¼š

```bash
# åˆ é™¤æ•°æ®åº“
rm src/WorkFlowCore.API/workflow_dev.db

# é‡æ–°å¯åŠ¨åº”ç”¨
dotnet run --project src/WorkFlowCore.API
```

---

## âš ï¸ å®‰å…¨å»ºè®®

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰å¿…é¡»ï¼š

1. **ä¿®æ”¹é»˜è®¤å¯†ç **ï¼š
   - ç®¡ç†å‘˜å¯†ç æ”¹ä¸ºå¼ºå¯†ç ï¼ˆè‡³å°‘ 12 ä½ï¼ŒåŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šå­—ç¬¦ï¼‰
   - ç¦ç”¨æˆ–åˆ é™¤æµ‹è¯•ç”¨æˆ·è´¦å·

2. **ä¿®æ”¹ JWT å¯†é’¥**ï¼š
   ```json
   // appsettings.Production.json
   "JwtSettings": {
     "SecretKey": "your-production-super-secret-key-at-least-32-characters"
   }
   ```

3. **ä¿®æ”¹ Token åŠ å¯†å¯†é’¥**ï¼š
   ```bash
   # å‰ç«¯ .env.production
   VITE_STORAGE_KEY=your-production-storage-key
   ```

4. **å¯ç”¨å¯†ç å¤æ‚åº¦ç­–ç•¥**ï¼ˆåœ¨ `WorkFlowCoreHttpApiModule.cs` ä¸­é…ç½®ï¼‰ï¼š
   ```csharp
   Configure<IdentityOptions>(options =>
   {
       options.Password.RequiredLength = 12;
       options.Password.RequireNonAlphanumeric = true;
       options.Password.RequireUppercase = true;
       options.Password.RequireLowercase = true;
       options.Password.RequireDigit = true;
   });
   ```

5. **å¯ç”¨ç™»å½•å¤±è´¥é”å®š**ï¼š
   ```csharp
   options.Lockout.DefaultLockoutTimeSpan = TimeSpan.FromMinutes(30);
   options.Lockout.MaxFailedAccessAttempts = 5;
   options.Lockout.AllowedForNewUsers = true;
   ```

---

## ğŸ“ å¸¸è§é—®é¢˜

### Q1: å¿˜è®°ç®¡ç†å‘˜å¯†ç æ€ä¹ˆåŠï¼Ÿ

**æ–¹æ³• 1**ï¼šåˆ é™¤æ•°æ®åº“é‡æ–°åˆå§‹åŒ–ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
```bash
rm src/WorkFlowCore.API/workflow_dev.db
dotnet run --project src/WorkFlowCore.API
```

**æ–¹æ³• 2**ï¼šä½¿ç”¨ EF Core è¿ç§»å·¥å…·ç›´æ¥ä¿®æ”¹æ•°æ®åº“ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
```bash
# è¿æ¥åˆ°æ•°æ®åº“
sqlite3 workflow_dev.db

# æ›´æ–°å¯†ç å“ˆå¸Œï¼ˆéœ€è¦å…ˆç”Ÿæˆæ–°å¯†ç çš„å“ˆå¸Œå€¼ï¼‰
UPDATE AbpUsers SET PasswordHash='<new-hash>' WHERE UserName='admin';
```

### Q2: ç™»å½•æç¤ºã€Œç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ã€ï¼Ÿ

æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. ç¡®è®¤åº”ç”¨å·²å¯åŠ¨ä¸”æ•°æ®åº“è¿ç§»å·²å®Œæˆ
2. æŸ¥çœ‹åç«¯å¯åŠ¨æ—¥å¿—ï¼Œç¡®è®¤ã€Œé»˜è®¤ç”¨æˆ·æ•°æ®å·²åˆå§‹åŒ–ã€
3. æ£€æŸ¥æ•°æ®åº“ `AbpUsers` è¡¨æ˜¯å¦å­˜åœ¨ `admin` ç”¨æˆ·
4. ç¡®è®¤å‰ç«¯ API åœ°å€é…ç½®æ­£ç¡®ï¼ˆ`VITE_API_BASE_URL`ï¼‰

### Q3: å¦‚ä½•æ·»åŠ æ›´å¤šé»˜è®¤ç”¨æˆ·ï¼Ÿ

ä¿®æ”¹ `src/WorkFlowCore.API/DataSeeder.cs`ï¼Œå‚ç…§ç°æœ‰ä»£ç æ·»åŠ æ–°ç”¨æˆ·ï¼š

```csharp
var newUser = new AppUser(
    Guid.NewGuid(),
    "newuser",
    email: "newuser@workflowcore.com",
    tenantId: null
)
{
    Name = "æ–°ç”¨æˆ·",
    Status = "0"
};

await userManager.CreateAsync(newUser, "newuser123");
await appUserSyncService.SyncOnCreateAsync(newUser);
```

---

**æ–‡æ¡£æ›´æ–°æ—¥æœŸ**ï¼š2025-11-23  
**ç‰ˆæœ¬**ï¼šv1.0

